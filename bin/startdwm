#!/bin/sh

STATUS="$HOME/.dotfiles/scripts/dwm_status"
BUILD="$HOME/.dotfiles/compile/dwm-wm/build.sh"

while true; do
    (sleep 0.5 && volumeicon) &     # volume icon in systray
    (sleep 0.5 && zsh -c $STATUS) & # run dzen2 status bar, need to make sure wm loads first

    # start dwm
    dwm 2> ~/.dwm.log
    # read exit status
    if [ $? -eq 0 ]; then
        exit 0 # means exit clean => quit
    fi
    # recompile and start again
    zsh -c $BUILD
    # kill running processes
    killall volumeicon dwm_status
done

